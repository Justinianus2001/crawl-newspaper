<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Flask and crawl data newspaper</title>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename = 'favicon.ico') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link type="text/css" rel="stylesheet" href="{{ url_for('static', filename = 'styles.css') }}">
</head>

<body>
    <form action="/" method="POST">
        <h3>
            Search Vietnamese online newspaper
            <a href="https://github.com/Justinianus2001/crawl_newspaper" target="_blank">
                <img src="{{ url_for('static', filename = 'github.ico') }}" alt="github.ico" class="icon">
            </a>
        </h3>

        <div class="input-group mb-3">
            <select name="tag" class="form-select" aria-label="Tag select">
                {% for tag in tags %}
                {% if tag == "ALL" %}
                <option value="{{ tag }}" {% if cur_tag==tag %} selected {% endif %}>Tất cả</option>
                {% else %}
                <option value="{{ tag }}" {% if cur_tag==tag %} selected {% endif %}>{{ tag.title() }}</option>
                {% endif %}
                {% endfor %}
            </select>
            <input type="text" name="search" class="form-control input" aria-label="Input title"
                placeholder="Bạn muốn tìm kiếm gì?" value="{{ cur_search if cur_search != None }}">
            <button class="btn btn-primary" type="submit">Tìm kiếm</button>
        </div>
    </form>
    <hr>
    {% if records | length != 0 %}
    <i>Đã tìm thấy {{ size }} kết quả.</i>
    <br><br>
    <table class="bordered">
        {% for record in records %}
        <tr>
            <th>
                <u>
                    <h5>{{ record["_source"]["tag"] }}</h5>
                </u>
                <h3>
                    <a href="{{ record['_source']['link'] }}" target="_blank">
                        <b>{{ record["_source"]["title"] }}</b>
                    </a>
                    {% if record["_score"] != 1 %}
                    (Score: {{ '%0.7f'| format(record["_score"] - 1|float) }})
                    {% endif %}
                </h3>
                <p>{{ record["_source"]["preview"] }}</p>
                <span class="right">Tác giả: {{ record["_source"]["author"] }}</span>
                <i class="right">{{ record["_source"]["timestamp"] }}</i>
            </th>
            <th><img src="{{ record['_source']['image'] }}" alt="Image" class="post_image"></th>
        </tr>
        {% endfor %}
    </table>
    {% else %}
    <i>Không tìm thấy kết quả.</i>
    {% endif %}

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
        integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"
        integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V"
        crossorigin="anonymous"></script>
</body>

</html>